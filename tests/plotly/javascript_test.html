<!doctype html>
    
<!-- An html page to test the server by querying for and displaying the data.
    To run:
        Run the server.
            In terminal or command line, type in 'python3 run.py' and hit enter
        Open this file in browser.
        The raw data should appear after a moment.
-->

<html lang="en">
<head>
    <title>Javascript Test</title>
    
    <!-- jquery to make ajax request -->
    <script src="jquery-3.1.1.min.js"></script>
    
    <!-- plotly.js wrapper class -->
    <script src = "myplotly.js"></script>
    

</head>
<body>
    
    <div id="myDiv" align="center" ></div>
                
    <script>
        
        const _url = "http://localhost:5000/jsonp"
        
        //callback function with the object resulting from the json data
        function processJSON(json){
                        
            console.log("received json object: " + json);
            
            if ( json.salts.length > 1) {
                console.log("rendering multiple frames...")
                animateHeatmap( "myDiv", json);
                //animateTraces("myTraces", json);
            } else {
                console.log("rendering single frame...")
                heatmap( "myDiv", json);
                
            }
            
        }
        
        function makeAJAX( _layers ) {        
            /* 'JSON Padded' Cross-origin Ajax request to the server */
            $.ajax({
                url: _url,
                dataType: "jsonp",
                data: { layers: _layers},
                jsonpCallback: "processJSON",
            });
            
            
        }
        
        /* Request a single layer to render a frame */
        makeAJAX( 40 );


    
    </script>

</body>
</html>
